@(
    @{
        VulnerabilityName = 'WannaCry' #this will be used when naming output files
        
        ApplicableHotfixes = @('KB4012214','KB4012217','KB4012213','KB4012216','KB4012212','KB4012215','KB4012606','4013198','4013429') # WannaCry:s https://technet.microsoft.com/library/security/MS17-010
        
        TargetFile = 'C:\Windows\System32\win32k.sys' #we will check this file's version
        
        FileVersions = @{
            Win6_1      = '6.1.7601.23677'   #https://support.microsoft.com/en-us/help/4012212/march-2007-security-only-quality-update-for-windows-7-sp1-and-windows-server-2008-r2-sp1 
            Win6_2      = '6.2.9200.22099'   #https://support.microsoft.com/en-us/help/4012217/march-2017-security-monthly-quality-rollup-for-windows-server-2012
            Win6_3      = '6.3.9600.18603'   #https://support.microsoft.com/en-us/help/4012213/march-2017-security-only-quality-update-for-windows-8-1-and-windows-server-2012-r2
            Win10_10240 = '10.0.10240.16384' #https://support.microsoft.com/en-sg/help/4019474 and scroll down to Fle Information bullet to download the CSV list of file versions.
            Win10_10586 = '10.0.10586.20'    #https://support.microsoft.com/en-sg/help/4019473 and scroll down to Fle Information bullet to download the CSV list of file versions.
            Win10_14393 = '10.0.14393.594'   #https://support.microsoft.com/en-sg/help/4013429 and scroll down to Fle Information bullet to download the CSV list of file versions.
            Win10_15063 = '10.0.15063.0'     #https://support.microsoft.com/en-sg/help/4020102 and scroll down to Fle Information bullet to download the CSV list of file versions.
        }
    }
)

<#
This manifest file is used to define the information about the virus you are trying to
identify vulnerabilities for.  It's formated as a array containing hash tables.
The definition for the WannCry virus is give below.
(Note: this is the contents of the .psd1 file)
    @(
        @{
            VulnerabilityName = 'WannaCry' #this will be used when naming output files
            
            ApplicableHotfixes = @('KB4012214','KB4012217','KB4012213','KB4012216','KB4012212','KB4012215') #https://technet.microsoft.com/library/security/MS17-010
            
            TargetFile = 'C:\Windows\System32\win32k.sys' #we will check this file's version
            
            FileVersions = @{
                # OS Versions: https://msdn.microsoft.com/en-us/library/windows/desktop/ms724832(v=vs.85).aspx
                # Note: For WannaCry, we did not notice a difference in file version between x64 and x86 architectures.
                #       For this reason, the tool was built to operate independent of architecture
                # Version 6.1 - Windows 7 / Windows Server 2008R2
                # Version 6.2 - Windows 8 / Windows server 2102
                # Version 6.3 - Windows 8.1 / Windows Server 2012R2
                # Version 10.0.10240 - Windows 10 Version 1507                Initial Release     Jul 2015  Threshold 1
                # Version 10.0.10586 - Windows 10 Version 1511                November Update     Nov 2015  Threshold 2
                # Version 10.0.14393 - Windows 10 & Server 2016 Version 1607  Anniversary Update  Aug 2016  Redstone 1
                # Version 10.0.15063 - Windows 10 Version 1703                Creators Update     Apr 2017  Redstone 2
                
                Win6_1 = '6.1.7601.23677' #https://support.microsoft.com/en-us/help/4012212/march-2007-security-only-quality-update-for-windows-7-sp1-and-windows-server-2008-r2-sp1 
                Win6_2 = '6.2.9200.22099' #https://support.microsoft.com/en-us/help/4012217/march-2017-security-monthly-quality-rollup-for-windows-server-2012
                Win6_3 = '6.3.9600.18603' #https://support.microsoft.com/en-us/help/4012213/march-2017-security-only-quality-update-for-windows-8-1-and-windows-server-2012-r2
                
                # For Windows 10 File Versions, consult this page: https://support.microsoft.com/en-sg/help/4018124/windows-10-update-history
                Win10_10240 = '10.0.10240.16384' #https://support.microsoft.com/en-sg/help/4019474 and scroll down to Fle Information bullet to download the CSV list of file versions.
                Win10_10586 = '10.0.10586.20'    #https://support.microsoft.com/en-sg/help/4019473 and scroll down to Fle Information bullet to download the CSV list of file versions.
                Win10_14393 = '10.0.14393.594'   #https://support.microsoft.com/en-sg/help/4013429 and scroll down to Fle Information bullet to download the CSV list of file versions.
                Win10_15063 = '10.0.15063.0'     #https://support.microsoft.com/en-sg/help/4020102 and scroll down to Fle Information bullet to download the CSV list of file versions.
            }
        }

        #create additional hash tables here to process multiple vulns or multiple files
    )
#>
